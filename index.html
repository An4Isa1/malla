import React, { useState } from "react";

const semesters = [
  { id: 1, name: "Semestre 1️⃣", color: "#d6eaf8", subjects: ["Historia Económica General", "Principios Constitucionales", "Metodología de la Investigación", "Matemáticas I", "Lectoescritura"] },
  { id: 2, name: "Semestre 2️⃣", color: "#aed6f1", subjects: ["Microeconomía I", "Matemáticas II", "Historia Económica de Colombia", "Contabilidad", "Introducción a la Economía"] },
  { id: 3, name: "Semestre 3️⃣", color: "#85c1e9", subjects: ["Macroeconomía I", "Estadística I", "Microeconomía II", "Desarrollo Económico", "Contabilidad II"] },
  { id: 4, name: "Semestre 4️⃣", color: "#7fb3d5", subjects: ["Macroeconomía II", "Estadística II", "Economía Colombiana", "Econometría I", "Epistemología"] },
  { id: 5, name: "Semestre 5️⃣", color: "#5499c7", subjects: ["Macroeconomía III", "Econometría II", "Historia del Pensamiento Económico", "Electiva I", "Economía Internacional"] },
  { id: 6, name: "Semestre 6️⃣", color: "#2980b9", subjects: ["Evaluación de Proyectos", "Electiva II", "Formulación y Evaluación de Proyectos", "Modelación Económica", "Economía del Sector Público"] },
  { id: 7, name: "Semestre 7️⃣", color: "#2471a3", subjects: ["Electiva III", "Seminario de Investigación I", "Taller de Coyuntura", "Finanzas Públicas", "Taller de Economía Regional"] },
  { id: 8, name: "Semestre 8️⃣", color: "#1f618d", subjects: ["Práctica Profesional", "Trabajo de Grado I", "Electiva IV", "Seminario de Economía Sectorial", "Electiva Complementaria"] },
  { id: 9, name: "Semestre 9️⃣", color: "#1a5276", subjects: ["Trabajo de Grado II", "Electiva V"] },
];

export default function PensumInteractivo() {
  const [selectedSubject, setSelectedSubject] = useState(null);
  const [subjectInfo, setSubjectInfo] = useState({});

  const handleSubjectClick = (semesterId, subject) => {
    setSelectedSubject({ semesterId, subject });
  };

  const handleChange = (field, value) => {
    const key = `${selectedSubject.semesterId}-${selectedSubject.subject}`;
    setSubjectInfo({
      ...subjectInfo,
      [key]: {
        ...subjectInfo[key],
        [field]: value,
      },
    });
  };

  const isComplete = (semesterId, subject) => {
    const key = `${semesterId}-${subject}`;
    const info = subjectInfo[key];
    return info?.profesor && info?.nota1 && info?.nota2 && info?.nota3;
  };

  return (
    <div className="p-6 space-y-6">
      <h1 className="text-3xl italic text-center">Pénsum Interactivo</h1>
      <p className="italic text-center">Haz clic en una materia para ingresar profesor y notas</p>

      {semesters.map((sem) => (
        <div key={sem.id} className="rounded-2xl p-4 shadow" style={{ backgroundColor: sem.color }}>
          <h2 className="text-xl font-semibold mb-2 italic">{sem.name}</h2>
          <div className="grid grid-cols-2 md:grid-cols-3 gap-2">
            {sem.subjects.map((subj) => {
              const complete = isComplete(sem.id, subj);
              return (
                <button
                  key={subj}
                  onClick={() => handleSubjectClick(sem.id, subj)}
                  className={`p-2 rounded-xl text-left font-[Times New Roman] bg-white/60 hover:bg-white transition border border-gray-300 ${complete ? "line-through" : ""}`}
                >
                  {subj}
                </button>
              );
            })}
          </div>

          {selectedSubject?.semesterId === sem.id && (
            <div className="mt-4 bg-white p-4 rounded-xl border">
              <h3 className="font-bold italic mb-2">Editar información de la materia</h3>
              <input
                type="text"
                placeholder="Nombre del profesor"
                className="w-full mb-2 p-2 rounded border font-[Times New Roman]"
                value={subjectInfo[`${sem.id}-${selectedSubject.subject}`]?.profesor || ""}
                onChange={(e) => handleChange("profesor", e.target.value)}
              />
              <div className="grid grid-cols-3 gap-2">
                {[1, 2, 3].map((n) => (
                  <input
                    key={n}
                    type="number"
                    step="0.01"
                    placeholder={`Nota ${n}`}
                    className="p-2 rounded border font-[Times New Roman]"
                    value={subjectInfo[`${sem.id}-${selectedSubject.subject}`]?.[`nota${n}`] || ""}
                    onChange={(e) => handleChange(`nota${n}`, e.target.value)}
                  />
                ))}
              </div>
            </div>
          )}
        </div>
      ))}
    </div>
  );
}
